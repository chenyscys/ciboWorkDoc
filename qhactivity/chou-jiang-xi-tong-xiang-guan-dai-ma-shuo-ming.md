抽奖系统的核心代码都在**app/Http/Controllers/Admin/DrawController.php**文件上，以下是每次活动的操作流程。

1、**超级管理员**进入系统 → 添加活动 → 配置对应奖项。

2、请erp系统管理人员（温东亮，谭建曦，曾坤）进行抽奖活动配置 → 然后把**活动代号**给到叶润章，修改企业微信扫一扫上的订单录入功能的 活动 ID

3、根据现场活动类型（看备注），添加现场活动订单录入 入口到企业微信上，流程如下：

找**叶润章，**把对应的type给他，有几个现场活动，就让他添加几个录入 入口。

4、每次活动，都需要设计人员设计一个对应获得的大屏抽奖页面的**banner**以及手机查询的**banner**图，共两张。

图片路径：①大屏banner：public/images/admin/banner.jpg；

②手机端banner：public/images/admin/title2.jpg；

5、活动测试：在有订单二维码之后，可通过修改活动当天日期，进行扫码录入订单，模拟抽奖，此时可把对应的表改为测试表，以免混淆真实数据。

修改方式：**app/Entities/PartyOrder.php 文件上修改，打开文件看下注释就明白了。**

6、抽奖界面滚动特效：

文件：常规抽奖：resources/views/admin/draw/index.blade.php，免单：resources/views/admin/draw/finalDraw.blade.php

修改显示馆号：查询搜索 getGroup，要随机显示几个馆号，传进一个数组，如只显示1，2，5，就传 \[1,2,5\] 即可。



备注：

每次终极抽奖（正常情况）：

1-3号馆，3000起步参与抽奖，每3000一次抽奖机会；

4-5号馆，5000起步参与抽奖，每5000一次抽奖机会；

如有变动，请进入核心代码文件进行修改。代码有注释说明。

活动类型：1、砸金蛋；2、即买即抽；3、优惠券抽奖；4、满额送；5、抢购；6、的士报销；7、联购返现

关于 **party\_order **和 **party\_order\_repeat **两表存在的意义：

一般情况下，只会用到**party\_order **一表，也就是说一个订单只会参与一次抽奖，也即录入一次。

但有特别的情况，如18年国庆，10.1号的订单，可以参与1号的抽奖，同时可以参与7号的抽奖，这就比较难搞了，因为订单录入不能录入两次的，不然就乱了，因此 **party\_order\_repeat **应运而生。

当两场活动中，有订单号可以参与重复活动的时候，这时候要把第二场抽奖活动的订单表，改为 **party\_order\_repeat，**表结构是一样的。这样就不用担心实现第二场活动抽奖，订单重复的问题了。

修改方式：**app/Entities/PartyOrder.php 文件上修改，打开文件看下注释就明白了。**

